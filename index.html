import React, { useState, useEffect } from 'react';
import { Activity, Clock, Heart, AlertTriangle, BookOpen, CheckCircle, Play, Pause, RotateCcw } from 'lucide-react';

const AdembHelper = () => {
  const [activeTab, setActiveTab] = useState('dashboard');
  const [timer, setTimer] = useState(0);
  const [isRunning, setIsRunning] = useState(false);
  const [currentStep, setCurrentStep] = useState(0);
  const [sessionData, setSessionData] = useState({
    intensityBefore: 5,
    intensityAfter: 5,
    notes: ''
  });
  
  // Dagboek entries worden bijgehouden in de app tijdens je sessie
  const [dagboekEntries, setDagboekEntries] = useState([]);
  const [showDagboekModal, setShowDagboekModal] = useState(false);
  const [currentOefening, setCurrentOefening] = useState(null);

  // Timer effect
  useEffect(() => {
    let interval;
    if (isRunning && timer > 0) {
      interval = setInterval(() => {
        setTimer(timer => timer - 1);
      }, 1000);
    } else if (timer === 0) {
      setIsRunning(false);
    }
    return () => clearInterval(interval);
  }, [isRunning, timer]);

  const startTimer = (seconds) => {
    setTimer(seconds);
    setIsRunning(true);
  };

  const formatTime = (seconds) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins}:${secs.toString().padStart(2, '0')}`;
  };

  const startDagboekEntry = (oefeningType) => {
    setCurrentOefening(oefeningType);
    setShowDagboekModal(true);
  };

  const saveDagboekEntry = (entry) => {
    const newEntry = {
      ...entry,
      datum: new Date().toLocaleString('nl-BE'),
      id: Date.now()
    };
    setDagboekEntries([newEntry, ...dagboekEntries]);
    setShowDagboekModal(false);
    setCurrentOefening(null);
  };

  const afkoelRitueel = [
    {
      title: "Fysieke Mini-Reset",
      duration: 120,
      instructions: [
        "Sta op en strek je volledig uit",
        "Schud je armen en benen los",
        "Rol je schouders 5x naar achteren",
        "Maak kleine cirkels met je hoofd (5x elke richting)"
      ]
    },
    {
      title: "Zintuigelijke Verschuiving", 
      duration: 120,
      instructions: [
        "Raak 5 verschillende texturen aan in je omgeving",
        "Luister bewust naar 3 geluiden die je kunt horen",
        "Kijk naar iets aangenaams in de verte"
      ]
    },
    {
      title: "Voedings-ankerpunt",
      duration: 120,
      instructions: [
        "Drink een half glas water, langzaam en bewust",
        "Eet iets kleins met een sterke smaak",
        "Let op de smaak en textuur in je mond"
      ]
    },
    {
      title: "Mentale Overgang",
      duration: 120,
      instructions: [
        "Schrijf 3 woorden op die samenvatten waar je net aan werkte",
        "Schrijf daaronder 3 woorden voor wat je nu gaat doen",
        "Trek een lijn tussen deze sets woorden als symbolische afsluiting"
      ]
    },
    {
      title: "Bewegingsafsluiting",
      duration: 120,
      instructions: [
        "Loop even rond, bij voorkeur buiten of bij een open raam",
        "Maak 5-10 trage, bewuste stappen",
        "Eindig met een kleine glimlach"
      ]
    }
  ];

  const DagboekModal = () => {
    const [dagboekEntry, setDagboekEntry] = useState({
      trigger: currentOefening ? `Tijdens/na ${currentOefening}` : '',
      intensiteitVoor: 5,
      intensiteitNa: 5,
      techniekGebruikt: currentOefening || '',
      resultaat: '',
      notities: ''
    });

    if (!showDagboekModal) return null;

    return (
      <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div className="bg-white rounded-lg p-6 max-w-md w-full max-h-96 overflow-y-auto">
          <h3 className="text-lg font-semibold mb-4">üìù Dagboek Entry</h3>
          
          <div className="space-y-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Situatie/Trigger:
              </label>
              <input
                type="text"
                value={dagboekEntry.trigger}
                onChange={(e) => setDagboekEntry({...dagboekEntry, trigger: e.target.value})}
                className="w-full p-2 border border-gray-300 rounded text-sm"
              />
            </div>

            <div className="grid grid-cols-2 gap-3">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Intensiteit voor (1-10):
                </label>
                <input
                  type="range"
                  min="1"
                  max="10"
                  value={dagboekEntry.intensiteitVoor}
                  onChange={(e) => setDagboekEntry({...dagboekEntry, intensiteitVoor: e.target.value})}
                  className="w-full"
                />
                <div className="text-center text-sm font-bold">{dagboekEntry.intensiteitVoor}</div>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Intensiteit na (1-10):
                </label>
                <input
                  type="range"
                  min="1"
                  max="10"
                  value={dagboekEntry.intensiteitNa}
                  onChange={(e) => setDagboekEntry({...dagboekEntry, intensiteitNa: e.target.value})}
                  className="w-full"
                />
                <div className="text-center text-sm font-bold">{dagboekEntry.intensiteitNa}</div>
              </div>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Resultaat:
              </label>
              <select
                value={dagboekEntry.resultaat}
                onChange={(e) => setDagboekEntry({...dagboekEntry, resultaat: e.target.value})}
                className="w-full p-2 border border-gray-300 rounded text-sm"
              >
                <option value="">Selecteer resultaat...</option>
                <option value="zeer-goed">Zeer goed - volledig opgelost</option>
                <option value="goed">Goed - duidelijke verbetering</option>
                <option value="matig">Matig - kleine verbetering</option>
                <option value="geen-effect">Geen effect</option>
                <option value="slechter">Iets slechter</option>
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Notities:
              </label>
              <textarea
                value={dagboekEntry.notities}
                onChange={(e) => setDagboekEntry({...dagboekEntry, notities: e.target.value})}
                placeholder="Wat viel je op?"
                rows="2"
                className="w-full p-2 border border-gray-300 rounded text-sm"
              ></textarea>
            </div>

            <div className="flex space-x-2">
              <button
                onClick={() => saveDagboekEntry(dagboekEntry)}
                className="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700 text-sm"
              >
                Opslaan
              </button>
              <button
                onClick={() => setShowDagboekModal(false)}
                className="flex-1 bg-gray-600 text-white py-2 rounded hover:bg-gray-700 text-sm"
              >
                Annuleren
              </button>
            </div>
          </div>
        </div>
      </div>
    );
  };

  const gaapTechnieken = [
    {
      title: "Lipremming-techniek",
      description: "Druk je lippen zachtjes op elkaar wanneer je een gaapneiging voelt. Laat de lucht langzaam door je neus in en uit gaan."
    },
    {
      title: "Mini-ademhalingen",
      description: "Neem bewust 3-4 zeer kleine, ondiepe ademhalingen door je neus. Hiermee voorkom je de grote 'zucht-ademhaling'."
    },
    {
      title: "Tongpositie veranderen",
      description: "Plaats je tongpunt tegen je gehemelte (achter je voortanden). Dit vermindert de neiging tot gapen."
    },
    {
      title: "Water drinken",
      description: "Neem kleine slokjes water wanneer je merkt dat je begint te gapen. Dit doorbreekt het ademhalingspatroon."
    }
  ];

  const DashboardTab = () => (
    <div className="p-6 space-y-6">
      <div className="bg-gradient-to-r from-blue-50 to-green-50 p-6 rounded-lg border border-blue-200">
        <h2 className="text-2xl font-bold text-blue-800 mb-2">Welkom bij Ademruimte</h2>
        <p className="text-blue-700">Jouw persoonlijke hulp voor het omgaan met hyperventilatie en luchthonger-gevoelens.</p>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <button
          onClick={() => setActiveTab('crisis')}
          className="bg-red-50 p-4 rounded-lg border border-red-200 hover:bg-red-100 transition-colors text-left"
        >
          <div className="flex items-center space-x-2 mb-2">
            <AlertTriangle className="h-5 w-5 text-red-600" />
            <h3 className="font-semibold text-red-800">Crisis Hulp</h3>
          </div>
          <p className="text-red-700 text-sm">Voor wanneer je luchthonger voelt opkomen</p>
        </button>

        <button
          onClick={() => setActiveTab('ritueel')}
          className="bg-green-50 p-4 rounded-lg border border-green-200 hover:bg-green-100 transition-colors text-left"
        >
          <div className="flex items-center space-x-2 mb-2">
            <Clock className="h-5 w-5 text-green-600" />
            <h3 className="font-semibold text-green-800">Afkoel Ritueel</h3>
          </div>
          <p className="text-green-700 text-sm">Na intensief denkwerk</p>
        </button>

        <button
          onClick={() => setActiveTab('gapen')}
          className="bg-orange-50 p-4 rounded-lg border border-orange-200 hover:bg-orange-100 transition-colors text-left"
        >
          <div className="flex items-center space-x-2 mb-2">
            <Activity className="h-5 w-5 text-orange-600" />
            <h3 className="font-semibold text-orange-800">Gaap Preventie</h3>
          </div>
          <p className="text-orange-700 text-sm">Technieken voor gaapaanvallen</p>
        </button>

        <button
          onClick={() => setActiveTab('emdr')}
          className="bg-purple-50 p-4 rounded-lg border border-purple-200 hover:bg-purple-100 transition-colors text-left"
        >
          <div className="flex items-center space-x-2 mb-2">
            <Heart className="h-5 w-5 text-purple-600" />
            <h3 className="font-semibold text-purple-800">EMDR Zelfhulp</h3>
          </div>
          <p className="text-purple-700 text-sm">Voor luchthonger-gevoelens</p>
        </button>

        <button
          onClick={() => setActiveTab('dagboek')}
          className="bg-blue-50 p-4 rounded-lg border border-blue-200 hover:bg-blue-100 transition-colors text-left"
        >
          <div className="flex items-center space-x-2 mb-2">
            <BookOpen className="h-5 w-5 text-blue-600" />
            <h3 className="font-semibold text-blue-800">Dagboek</h3>
          </div>
          <p className="text-blue-700 text-sm">Bijhouden van patronen</p>
        </button>
      </div>

      <div className="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
        <h3 className="font-semibold text-yellow-800 mb-2">üí° Tip van de dag</h3>
        <p className="text-yellow-700">Herinner je: gaapaanvallen zijn een waarschuwingssignaal, geen bedreiging. Gebruik ze als mogelijkheid om preventief in te grijpen.</p>
      </div>
    </div>
  );

  const CrisisTab = () => (
    <div className="p-6 space-y-6">
      <div className="bg-red-50 p-4 rounded-lg border border-red-200">
        <h2 className="text-xl font-bold text-red-800 mb-2">üö® Crisis Hulp - Luchthonger</h2>
        <p className="text-red-700">Voor wanneer je dat benauwde gevoel voelt opkomen</p>
      </div>

      <div className="bg-white p-4 rounded-lg border border-gray-200">
        <h3 className="font-semibold mb-3">Directe Hulp Technieken</h3>
        <div className="space-y-4">
          <div className="p-3 bg-blue-50 rounded border border-blue-200">
            <h4 className="font-medium text-blue-800">1. Paradoxale Ademhaling</h4>
            <p className="text-blue-700 text-sm mt-1">
              Start met bewust zeer kleine, korte ademhalingen. Na 3-4 van deze mini-ademhalingen, probeer een iets langere uitademing.
            </p>
          </div>
          
          <div className="p-3 bg-green-50 rounded border border-green-200">
            <h4 className="font-medium text-green-800">2. Purse-lip Ademhaling</h4>
            <p className="text-green-700 text-sm mt-1">
              Tuut je lippen bij het uitademen om lichte weerstand te cre√´ren. Dit helpt bij luchthonger en stabiliseert CO2-niveaus.
            </p>
          </div>

          <div className="p-3 bg-purple-50 rounded border border-purple-200">
            <h4 className="font-medium text-purple-800">3. IJswater Techniek</h4>
            <p className="text-purple-700 text-sm mt-1">
              Breng iets kouds tegen je gezicht (vooral rond wangen en ogen) om de duikreflex te activeren.
            </p>
          </div>

          <div className="p-3 bg-orange-50 rounded border border-orange-200">
            <h4 className="font-medium text-orange-800">4. Herframing</h4>
            <p className="text-orange-700 text-sm mt-1">
              "Dit is geen echt zuurstoftekort, dit is een sensatie die voorbij zal gaan. Mijn lichaam krijgt genoeg zuurstof."
            </p>
          </div>
        </div>
      </div>

      <div className="bg-gray-50 p-4 rounded-lg">
        <h3 className="font-semibold mb-2">5-4-3-2-1 Grounding</h3>
        <ul className="text-gray-700 space-y-1 text-sm">
          <li>‚Ä¢ 5 dingen die je ZIET</li>
          <li>‚Ä¢ 4 dingen die je VOELT</li>
          <li>‚Ä¢ 3 dingen die je HOORT</li>
          <li>‚Ä¢ 2 dingen die je RUIKT</li>
          <li>‚Ä¢ 1 ding dat je PROEFT</li>
        </ul>
      </div>

      <div className="bg-blue-50 p-4 rounded-lg border border-blue-200">
        <h3 className="font-semibold text-blue-800 mb-2">‚úÖ Technieken gebruikt?</h3>
        <p className="text-blue-700 text-sm mb-3">
          Houd bij hoe de crisis-technieken hebben geholpen door een dagboekentry te maken.
        </p>
        <button
          onClick={() => startDagboekEntry('Crisis Hulp Technieken')}
          className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 text-sm"
        >
          üìù Dagboek Entry Maken
        </button>
      </div>
    </div>
  );

  const RitueelTab = () => (
    <div className="p-6 space-y-6">
      <div className="bg-green-50 p-4 rounded-lg border border-green-200">
        <h2 className="text-xl font-bold text-green-800 mb-2">üïê Afkoel Ritueel</h2>
        <p className="text-green-700">Voor na periodes van intensief denkwerk (5-10 minuten)</p>
      </div>

      {currentStep < afkoelRitueel.length ? (
        <div className="bg-white p-6 rounded-lg border border-gray-200">
          <div className="flex items-center justify-between mb-4">
            <h3 className="text-lg font-semibold">
              Stap {currentStep + 1}: {afkoelRitueel[currentStep].title}
            </h3>
            <div className="text-2xl font-mono bg-gray-100 px-3 py-1 rounded">
              {formatTime(timer)}
            </div>
          </div>

          <div className="space-y-2 mb-4">
            {afkoelRitueel[currentStep].instructions.map((instruction, index) => (
              <div key={index} className="flex items-center space-x-2">
                <CheckCircle className="h-4 w-4 text-green-500" />
                <span className="text-gray-700">{instruction}</span>
              </div>
            ))}
          </div>

          <div className="flex space-x-2">
            {!isRunning ? (
              <button
                onClick={() => startTimer(afkoelRitueel[currentStep].duration)}
                className="flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
              >
                <Play className="h-4 w-4" />
                <span>Start Timer</span>
              </button>
            ) : (
              <button
                onClick={() => setIsRunning(false)}
                className="flex items-center space-x-2 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"
              >
                <Pause className="h-4 w-4" />
                <span>Pause</span>
              </button>
            )}

            {timer === 0 && currentStep < afkoelRitueel.length - 1 && (
              <button
                onClick={() => setCurrentStep(currentStep + 1)}
                className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
              >
                Volgende Stap
              </button>
            )}

            <button
              onClick={() => {
                setCurrentStep(0);
                setTimer(0);
                setIsRunning(false);
              }}
              className="flex items-center space-x-2 bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"
            >
              <RotateCcw className="h-4 w-4" />
              <span>Reset</span>
            </button>
          </div>

          <div className="mt-4 bg-gray-100 rounded-full h-2">
            <div
              className="bg-green-600 h-2 rounded-full transition-all duration-300"
              style={{ width: `${((currentStep + 1) / afkoelRitueel.length) * 100}%` }}
            ></div>
          </div>
        </div>
      ) : (
        <div className="bg-green-50 p-6 rounded-lg border border-green-200 text-center">
          <CheckCircle className="h-12 w-12 text-green-600 mx-auto mb-3" />
          <h3 className="text-lg font-semibold text-green-800 mb-2">Afkoel Ritueel Voltooid!</h3>
          <p className="text-green-700 mb-4">Goed gedaan! Je hebt alle stappen doorlopen.</p>
          <div className="space-y-2">
            <button
              onClick={() => startDagboekEntry('Afkoel Ritueel')}
              className="w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mb-2"
            >
              üìù Dagboek Entry Maken
            </button>
            <button
              onClick={() => {
                setCurrentStep(0);
                setTimer(0);
                setIsRunning(false);
              }}
              className="w-full bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
            >
              Opnieuw Starten
            </button>
          </div>
        </div>
      )}
    </div>
  );

  const GapenTab = () => (
    <div className="p-6 space-y-6">
      <div className="bg-orange-50 p-4 rounded-lg border border-orange-200">
        <h2 className="text-xl font-bold text-orange-800 mb-2">ü•± Gaap Preventie Technieken</h2>
        <p className="text-orange-700">Voor wanneer je die vervelende gaapaanvallen voelt opkomen</p>
      </div>

      <div className="space-y-4">
        {gaapTechnieken.map((techniek, index) => (
          <div key={index} className="bg-white p-4 rounded-lg border border-gray-200">
            <h3 className="font-semibold text-gray-800 mb-2">{techniek.title}</h3>
            <p className="text-gray-700">{techniek.description}</p>
          </div>
        ))}
      </div>

      <div className="bg-blue-50 p-4 rounded-lg border border-blue-200">
        <h3 className="font-semibold text-blue-800 mb-2">üí° Belangrijk om te onthouden</h3>
        <p className="text-blue-700">
          Gaapaanvallen zijn een waarschuwingssignaal, geen bedreiging. Ze geven je de kans om preventief in te grijpen 
          voordat een volledige hyperventilatie-episode begint.
        </p>
      </div>

      <div className="bg-gray-50 p-4 rounded-lg">
        <h3 className="font-semibold mb-2">Gedachte-Breaking Technieken</h3>
        <div className="space-y-2 text-sm text-gray-700">
          <p><strong>Paradoxale intentie:</strong> "Ok√© hersenen, jullie willen dat ik ga gapen? Prima, ik ga nu heel bewust gapen"</p>
          <p><strong>Herframing:</strong> "Mijn brein probeert me te beschermen, maar ik hoef niet te reageren"</p>
          <p><strong>Aandacht verplaatsen:</strong> Tel 5 blauwe dingen die je kunt zien</p>
        </div>
      </div>

      <div className="bg-orange-50 p-4 rounded-lg border border-orange-200">
        <h3 className="font-semibold text-orange-800 mb-2">‚úÖ Technieken geprobeerd?</h3>
        <p className="text-orange-700 text-sm mb-3">
          Houd bij welke gaap-preventie technieken hebben geholpen.
        </p>
        <button
          onClick={() => startDagboekEntry('Gaap Preventie Technieken')}
          className="bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700 text-sm"
        >
          üìù Dagboek Entry Maken
        </button>
      </div>
    </div>
  );

  const EmdrTab = () => {
    const [emdrStep, setEmdrStep] = useState(0);
    const [intensity, setIntensity] = useState(5);

    const emdrStappen = [
      {
        title: "Voorbereiding",
        content: "Zorg dat je in een veilige, rustige ruimte bent. Heb water binnen handbereik. Stop als het te overweldigend wordt."
      },
      {
        title: "Doelgerichtheid",
        content: "Denk heel kort aan het gevoel van luchthonger (niet meer dan 5 seconden). Schat de intensiteit en formuleer: 'Ik kan met dit gevoel omgaan'"
      },
      {
        title: "Bilaterale Stimulatie",
        content: "Kies √©√©n optie: Oogbewegingen (langzaam links-rechts), Butterfly hug (tik afwisselend op schouders), of Knie-tikken"
      },
      {
        title: "Check-in",
        content: "Hoe voelt het luchthonger-gevoel nu? Welke gedachten komen op? Accepteer wat er komt zonder oordeel."
      },
      {
        title: "Positieve Verankering",
        content: "Focus op 'Ik kan hiermee omgaan' en doe 10-15 bilaterale bewegingen terwijl je deze gedachte vasthoudt."
      }
    ];

    return (
      <div className="p-6 space-y-6">
        <div className="bg-purple-50 p-4 rounded-lg border border-purple-200">
          <h2 className="text-xl font-bold text-purple-800 mb-2">üíú EMDR Zelfhulp</h2>
          <p className="text-purple-700">Voor luchthonger-gevoelens (dit is ondersteuning, geen vervanging voor professionele EMDR)</p>
        </div>

        <div className="bg-yellow-50 p-3 rounded-lg border border-yellow-200">
          <p className="text-yellow-800 text-sm">
            ‚ö†Ô∏è Gebruik dit alleen voor milde tot matige gevoelens. Stop als je je overweldigd voelt.
          </p>
        </div>

        <div className="bg-white p-6 rounded-lg border border-gray-200">
          <h3 className="text-lg font-semibold mb-4">
            Stap {emdrStep + 1}: {emdrStappen[emdrStep].title}
          </h3>
          
          <p className="text-gray-700 mb-4">{emdrStappen[emdrStep].content}</p>

          {emdrStep === 1 && (
            <div className="mb-4">
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Intensiteit van luchthonger-gevoel (1-10):
              </label>
              <input
                type="range"
                min="1"
                max="10"
                value={intensity}
                onChange={(e) => setIntensity(e.target.value)}
                className="w-full"
              />
              <div className="text-center mt-1 text-lg font-bold text-purple-600">{intensity}</div>
            </div>
          )}

          {emdrStep === 2 && (
            <div className="space-y-2 mb-4">
              <div className="p-2 bg-gray-50 rounded text-sm">
                <strong>Oogbewegingen:</strong> Beweeg je ogen langzaam van links naar rechts (15-20x)
              </div>
              <div className="p-2 bg-gray-50 rounded text-sm">
                <strong>Butterfly hug:</strong> Kruis je armen en tik afwisselend op je schouders
              </div>
              <div className="p-2 bg-gray-50 rounded text-sm">
                <strong>Knie-tikken:</strong> Tik afwisselend op je knie√´n met je handen
              </div>
            </div>
          )}

          <div className="flex space-x-2">
            {emdrStep > 0 && (
              <button
                onClick={() => setEmdrStep(emdrStep - 1)}
                className="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"
              >
                Vorige
              </button>
            )}
            
            {emdrStep < emdrStappen.length - 1 ? (
              <button
                onClick={() => setEmdrStep(emdrStep + 1)}
                className="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700"
              >
                Volgende
              </button>
            ) : (
              <div className="space-x-2">
                <button
                  onClick={() => startDagboekEntry('EMDR Zelfhulp Sessie')}
                  className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
                >
                  üìù Dagboek Entry
                </button>
                <button
                  onClick={() => setEmdrStep(0)}
                  className="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
                >
                  Opnieuw
                </button>
              </div>
            )}
          </div>

          <div className="mt-4 bg-gray-100 rounded-full h-2">
            <div
              className="bg-purple-600 h-2 rounded-full transition-all duration-300"
              style={{ width: `${((emdrStep + 1) / emdrStappen.length) * 100}%` }}
            ></div>
          </div>
        </div>
      </div>
    );
  };

  const DagboekTab = () => {
    const getResultaatColor = (resultaat) => {
      switch(resultaat) {
        case 'zeer-goed': return 'text-green-600';
        case 'goed': return 'text-green-500';
        case 'matig': return 'text-yellow-600';
        case 'geen-effect': return 'text-gray-600';
        case 'slechter': return 'text-red-600';
        default: return 'text-gray-600';
      }
    };

    const getResultaatText = (resultaat) => {
      switch(resultaat) {
        case 'zeer-goed': return 'Zeer goed';
        case 'goed': return 'Goed';
        case 'matig': return 'Matig';
        case 'geen-effect': return 'Geen effect';
        case 'slechter': return 'Slechter';
        default: return resultaat;
      }
    };

    return (
      <div className="p-6 space-y-6">
        <div className="bg-blue-50 p-4 rounded-lg border border-blue-200">
          <h2 className="text-xl font-bold text-blue-800 mb-2">üìñ Dagboek</h2>
          <p className="text-blue-700">Overzicht van je sessies en vooruitgang</p>
        </div>

        <div className="flex justify-between items-center">
          <h3 className="text-lg font-semibold">Recente Entries ({dagboekEntries.length})</h3>
          <button
            onClick={() => startDagboekEntry('Handmatige Entry')}
            className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 text-sm"
          >
            ‚ûï Nieuwe Entry
          </button>
        </div>

        {dagboekEntries.length === 0 ? (
          <div className="bg-gray-50 p-8 rounded-lg text-center">
            <BookOpen className="h-12 w-12 text-gray-400 mx-auto mb-3" />
            <h3 className="text-gray-600 font-medium mb-2">Nog geen entries</h3>
            <p className="text-gray-500 text-sm mb-4">
              Maak een dagboekentry na het gebruiken van oefeningen om patronen bij te houden.
            </p>
            <button
              onClick={() => startDagboekEntry('Eerste Entry')}
              className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 text-sm"
            >
              Maak je eerste entry
            </button>
          </div>
        ) : (
          <div className="space-y-4">
            {dagboekEntries.map((entry) => (
              <div key={entry.id} className="bg-white p-4 rounded-lg border border-gray-200">
                <div className="flex justify-between items-start mb-2">
                  <div>
                    <h4 className="font-medium text-gray-800">{entry.techniekGebruikt}</h4>
                    <p className="text-sm text-gray-600">{entry.datum}</p>
                  </div>
                  <span className={`text-sm font-medium ${getResultaatColor(entry.resultaat)}`}>
                    {getResultaatText(entry.resultaat)}
                  </span>
                </div>
                
                <div className="grid grid-cols-2 gap-4 mb-2">
                  <div className="text-sm">
                    <span className="text-gray-600">Voor:</span> 
                    <span className="font-medium ml-1">{entry.intensiteitVoor}/10</span>
                  </div>
                  <div className="text-sm">
                    <span className="text-gray-600">Na:</span> 
                    <span className="font-medium ml-1">{entry.intensiteitNa}/10</span>
                  </div>
                </div>

                {entry.trigger && (
                  <p className="text-sm text-gray-700 mb-1">
                    <strong>Trigger:</strong> {entry.trigger}
                  </p>
                )}

                {entry.notities && (
                  <p className="text-sm text-gray-700">
                    <strong>Notities:</strong> {entry.notities}
                  </p>
                )}
              </div>
            ))}
          </div>
        )}

        <div className="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
          <h3 className="font-semibold text-yellow-800 mb-2">üí° Data Opslag</h3>
          <p className="text-yellow-700 text-sm">
            <strong>Let op:</strong> Je dagboekentries worden alleen opgeslagen tijdens deze browsersessie. 
            Voor permanente opslag kun je belangrijke inzichten kopi√´ren naar je eigen notities of dokter.
          </p>
        </div>

        <div className="bg-gray-50 p-4 rounded-lg">
          <h3 className="font-semibold mb-2">Patronen om naar uit te kijken</h3>
          <ul className="text-gray-700 space-y-1 text-sm">
            <li>‚Ä¢ Welke technieken het beste werken voor jou</li>
            <li>‚Ä¢ Tijdstippen waarop klachten vaker voorkomen</li>
            <li>‚Ä¢ Specifieke triggers (werk, stress, bepaalde gedachten)</li>
            <li>‚Ä¢ Verband tussen maagklachten en ademhalingsproblemen</li>
            <li>‚Ä¢ Verbetering in intensiteit scores over tijd</li>
          </ul>
        </div>
      </div>
    );
  };

  const Navigation = () => (
    <nav className="bg-white border-b border-gray-200 p-4">
      <div className="flex space-x-1 overflow-x-auto">
        {[
          { id: 'dashboard', label: 'Dashboard', icon: Activity },
          { id: 'crisis', label: 'Crisis', icon: AlertTriangle },
          { id: 'ritueel', label: 'Ritueel', icon: Clock },
          { id: 'gapen', label: 'Gapen', icon: Activity },
          { id: 'emdr', label: 'EMDR', icon: Heart },
          { id: 'dagboek', label: 'Dagboek', icon: BookOpen }
        ].map(({ id, label, icon: Icon }) => (
          <button
            key={id}
            onClick={() => setActiveTab(id)}
            className={`flex items-center space-x-2 px-3 py-2 rounded transition-colors whitespace-nowrap ${
              activeTab === id
                ? 'bg-blue-100 text-blue-800 border border-blue-200'
                : 'text-gray-600 hover:text-gray-800 hover:bg-gray-100'
            }`}
          >
            <Icon className="h-4 w-4" />
            <span className="text-sm font-medium">{label}</span>
          </button>
        ))}
      </div>
    </nav>
  );

  return (
    <div className="min-h-screen bg-gray-50">
      <header className="bg-blue-600 text-white p-6">
        <h1 className="text-2xl font-bold">Ademruimte</h1>
        <p className="text-blue-100">Jouw persoonlijke hyperventilatie helper</p>
      </header>

      <Navigation />

      <main className="max-w-4xl mx-auto">
        {activeTab === 'dashboard' && <DashboardTab />}
        {activeTab === 'crisis' && <CrisisTab />}
        {activeTab === 'ritueel' && <RitueelTab />}
        {activeTab === 'gapen' && <GapenTab />}
        {activeTab === 'emdr' && <EmdrTab />}
        {activeTab === 'dagboek' && <DagboekTab />}
      </main>

      <footer className="mt-12 p-4 text-center text-gray-500 text-sm">
        <p>üìû In noodgevallen: contacteer altijd je huisarts of spoeddiensten</p>
      </footer>

      <DagboekModal />
          // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyBd7qyX8x12QA93xygMX9oKenJJvlQBIIw",
  authDomain: "my-helper-14982.firebaseapp.com",
  projectId: "my-helper-14982",
  storageBucket: "my-helper-14982.firebasestorage.app",
  messagingSenderId: "179439366636",
  appId: "1:179439366636:web:dd30f99dcd549ac31950c9",
  measurementId: "G-GYN5X778B4"
};
    </div>
  );
};

export default AdembHelper;
